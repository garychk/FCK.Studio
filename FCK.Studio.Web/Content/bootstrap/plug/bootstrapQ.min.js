$.fn.qdata = function () { var d = {}; var e = $(this).attr("data"); if (e) { var a = e.split(";"); for (var c = 0; c < a.length; c++) { if (a[c]) { var b = a[c].split(":"); d[b[0]] = b[1] } } } return d }; var qiao = {}; qiao.ajaxoptions = { url: "", data: {}, type: "post", dataType: "json", async: false }; qiao.ajaxopt = function (a) { var b = $.extend({}, qiao.ajaxoptions); if (typeof a == "string") { b.url = a } else { $.extend(b, a) } return b }; qiao.ajax = function (a) { if (!a) { alert("need options") } else { var b; $.ajax(qiao.ajaxopt(a)).done(function (c) { b = c }); return b } }; qiao.on = function (c, b, a) { $(document).off(b, c).on(b, c, a) }; bootstrapQ = {}; bootstrapQ.modaloptions = { url: "", fade: "fade", close: true, title: "title", btn: false, okbtn: "\u786e\u5b9a", qubtn: "\u53d6\u6d88", msg: "msg", big: false, show: false, remote: false, backdrop: "static", keyboard: true, style: "" }; bootstrapQ.modalstr = function (e) { var f = '<div class="modal ' + e.fade + '" id="bsmodal" tabindex="-1" role="dialog" aria-labelledby="bsmodaltitle" aria-hidden="true" style="position:fixed;top:20px;' + e.style + '">'; if (e.big) { f += '<div class="modal-dialog modal-lg"><div class="modal-content">' } else { f += '<div class="modal-dialog"><div class="modal-content">' } var b = "</div></div></div>"; var d = '<div class="modal-header">'; if (e.close) { d += '<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>' } d += '<h3 class="modal-title" id="bsmodaltitle">' + e.title + "</h3></div>"; var a = '<div class="modal-body"><p><h4>' + e.msg + "</h4></p></div>"; var c = '<div class="modal-footer"><button type="button" class="btn btn-primary bsok">' + e.okbtn + "</button>"; if (e.btn) { c += '<button type="button" class="btn btn-default bscancel">' + e.qubtn + "</button>" } c += "</div>"; return f + d + a + c + b }; bootstrapQ.alert = function (b, d) { var c = $.extend({}, bootstrapQ.modaloptions); c.title = "\u63d0\u793a"; if (typeof b == "string") { c.msg = b } else { $.extend(c, b) } $("#bsmodal").remove(); $(".modal-backdrop").remove(); $("body").append(bootstrapQ.modalstr(c)); var a = $("#bsmodal"); a.modal(c); qiao.on("button.bsok", "click", function () { if (d) { d() } a.modal("hide") }); qiao.on("#bsmodal", "hidden.bs.modal", function () { a.remove() }); a.modal("show") }; bootstrapQ.confirm = function (b, d, e) { var c = $.extend({}, bootstrapQ.modaloptions); c.title = "\u786e\u8ba4\u64cd\u4f5c"; if (typeof b == "string") { c.msg = b } else { $.extend(c, b) } c.btn = true; $("#bsmodal").remove(); $(".modal-backdrop").remove(); $("body").append(bootstrapQ.modalstr(c)); var a = $("#bsmodal"); a.modal(c); qiao.on("button.bsok", "click", function () { if (d) { d() } a.modal("hide") }); qiao.on("button.bscancel", "click", function () { if (e) { e() } a.modal("hide") }); qiao.on("#bsmodal", "hidden.bs.modal", function () { a.remove() }); a.modal("show") }; bootstrapQ.dialog = function (b, e) { var d = $.extend({}, bootstrapQ.modaloptions, b); d.big = true; $("#bsmodal").remove(); $(".modal-backdrop").remove(); $("body").append(bootstrapQ.modalstr(d)); var c = qiao.ajax({ url: b.url, dataType: "html" }); $("#bsmodal div.modal-body").empty().append(c); var a = $("#bsmodal"); a.modal(d); qiao.on("button.bsok", "click", function () { var f = true; if (e) { f = e() } if (f) { a.modal("hide") } }); qiao.on("#bsmodal", "hidden.bs.modal", function () { a.remove() }); a.modal("show") }; bootstrapQ.msgoptions = { msg: "msg", type: "info", time: 2000 }; bootstrapQ.msgstr = function (b, a) { return '<div class="alert alert-' + a + ' alert-dismissible" role="alert" style="display:none;position:fixed;top:0;left:0;width:100%;z-index:2001;margin:0;text-align:center;" id="bsalert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>' + b + "</div>" }; bootstrapQ.msg = function (a) { var b = $.extend({}, bootstrapQ.msgoptions); if (typeof a == "string") { b.msg = a } else { $.extend(b, a) } $("body").prepend(bootstrapQ.msgstr(b.msg, b.type)); $("#bsalert").slideDown(); setTimeout(function () { $("#bsalert").slideUp(function () { $("#bsalert").remove() }) }, b.time) }; bootstrapQ.popoptions = { animation: true, container: "body", content: "content", html: true, placement: "bottom", title: "", trigger: "hover" }; $.fn.bstip = function (a) { var b = $.extend({}, bootstrapQ.popoptions); if (typeof a == "string") { b.title = a } else { $.extend(b, a) } $(this).data(b).tooltip() }; $.fn.bspop = function (a) { var b = $.extend({}, bootstrapQ.popoptions); if (typeof a == "string") { b.content = a } else { $.extend(b, a) } $(this).popover(b) }; bootstrapQ.tree = {}; bootstrapQ.tree.options = { url: "/ucenter/menu", height: "600px", open: true, edit: false, checkbox: false, showurl: true }; $.fn.bstree = function (c) { var g = $.extend({}, bootstrapQ.tree.options); if (c) { if (typeof c == "string") { g.url = c } else { $.extend(g, c) } } var f = "\u52a0\u8f7d\u5931\u8d25\uff01"; var e = qiao.ajax(g.url + "/tree"); if (e && e.object) { var a = e.object; var h = '<div class="panel panel-info"><div class="panel-body" '; if (g.height != "auto") { h += 'style="height:600px;overflow-y:auto;"' } h += '><ul class="nav nav-list sidenav" id="treeul" data="url:' + g.url + ';">'; var d = bootstrapQ.tree.sub(a, g); var b = "</ul></div></div>"; f = h + d + b } $(this).empty().append(f); bootstrapQ.tree.init() }; bootstrapQ.tree.sub = function (a, e) {
    var d = ""; if (a) {
        var d = "<li>" + '<a href="javascript:void(0);" data="id:' + a.id + ";url:" + a.url + ';">' + '<span class="glyphicon glyphicon-minus"></span>';
        if (e.checkbox) { d += '<input type="checkbox" class="treecheckbox" '; if (a.checked) { d += "checked" } d += "/>" } d += a.text; if (e.showurl) { d += "(" + a.url + ")" } if (e.edit) { d += '&nbsp;&nbsp;<span class="label label-primary bstreeadd">\u6dfb\u52a0\u5b50\u83dc\u5355</span>' + '&nbsp;&nbsp;<span class="label label-primary bstreeedit">\u4fee\u6539</span>' + '&nbsp;&nbsp;<span class="label label-danger  bstreedel">\u5220\u9664</span>' } d += "</a>"; var c = a.children; if (c && c.length > 0) { d += '<ul style="padding-left:20px;" id="treeid_' + a.id + '" class="nav collapse '; if (e.open) { d += "in" } d += '">'; for (var b = 0; b < c.length; b++) { d += bootstrapQ.tree.sub(c[b], e) } d += "</ul>" } d += "</li>"
    } return d
}; bootstrapQ.tree.init = function () { qiao.on("#treeul .glyphicon-minus", "click", function () { if ($(this).parent().next().length > 0) { $("#treeid_" + $(this).parents("a").qdata().id).collapse("hide"); $(this).removeClass("glyphicon-minus").addClass("glyphicon-plus") } }); qiao.on("#treeul .glyphicon-plus", "click", function () { if ($(this).parent().next().length > 0) { $("#treeid_" + $(this).parents("a").qdata().id).collapse("show"); $(this).removeClass("glyphicon-plus").addClass("glyphicon-minus") } }); qiao.on("input.treecheckbox", "change", function () { var b = $(this).prop("checked"); $(this).parent().next().find("input.treecheckbox").each(function () { $(this).prop("checked", b) }); var c = true; var a = $(this).parent().parent().parent(); a.children().each(function () { var d = $(this).children().children("input").prop("checked"); if (!d) { c = false } }); a.prev().children("input").prop("checked", c) }); bootstrapQ.tree.url = $("#treeul").qdata().url; if (bootstrapQ.tree.url) { qiao.on(".bstreeadd", "click", bootstrapQ.tree.addp); qiao.on(".bstreedel", "click", bootstrapQ.tree.del); qiao.on(".bstreeedit", "click", bootstrapQ.tree.editp) } }; bootstrapQ.tree.addp = function () { bootstrapQ.dialog({ url: bootstrapQ.tree.url + "/add/" + $(this).parent().qdata().id, title: "\u6dfb\u52a0\u5b50\u83dc\u5355", okbtn: "\u4fdd\u5b58" }, function () { }) }; bootstrapQ.tree.del = function () { var a = qiao.ajax({ url: bootstrapQ.tree.url + "/del/" + $(this).parent().qdata().id }); bootstrapQ.msg(a) }; bootstrapQ.tree.editp = function () { bootstrapQ.dialog({ url: bootstrapQ.tree.url + "/savep?id=" + $(this).parent().qdata().id, title: "\u4fee\u6539\u83dc\u5355", okbtn: "\u4fdd\u5b58" }, function () { }) }; bootstrapQ.bstrooptions = { width: "500px", html: "true", nbtext: "\u4e0b\u4e00\u6b65", place: "bottom", title: "\u7f51\u7ad9\u4f7f\u7528\u5f15\u5bfc", content: "content" }; bootstrapQ.bstroinit = function (a, c, e) { if (a) { var b = $(a); if (b.length > 0) { var d = $.extend({}, bootstrapQ.bstrooptions, c); if (typeof c == "string") { d.content = c } else { $.extend(d, c) } b.each(function () { $(this).attr({ "data-bootstro-width": d.width, "data-bootstro-title": d.title, "data-bootstro-html": d.html, "data-bootstro-content": d.content, "data-bootstro-placement": d.place, "data-bootstro-nextButtonText": d.nbtext, "data-bootstro-step": e }).addClass("bootstro") }) } } }; bootstrapQ.bstroopts = { prevButtonText: "\u4e0a\u4e00\u6b65", finishButton: '<button class="btn btn-lg btn-success bootstro-finish-btn"><i class="icon-ok"></i>\u5b8c\u6210</button>', stopOnBackdropClick: false, stopOnEsc: false }; bootstrapQ.bstro = function (d, a) { if (d && d.length > 0) { for (var c = 0; c < d.length; c++) { bootstrapQ.bstroinit(d[c][0], d[c][1], c) } var b = $.extend({}, bootstrapQ.bstroopts); if (a) { if (a.hasOwnProperty("pbtn")) { b.prevButtonText = a.pbtn } if (a.hasOwnProperty("obtn")) { if (a.obtn == "") { b.finishButton = "" } else { b.finishButton = '<button class="btn btn-mini btn-success bootstro-finish-btn"><i class="icon-ok"></i>' + a.obtn + "</button>" } } if (a.hasOwnProperty("stop")) { b.stopOnBackdropClick = a.stop; b.stopOnEsc = a.stop } if (a.hasOwnProperty("exit")) { b.onExit = a.exit } } bootstro.start(".bootstro", b) } }; bootstrapQ.bsdateoptions = { autoclose: true, language: "zh-CN", format: "yyyy-mm-dd" }; bootstrapQ.bsdate = function (a, c) { if (a) { var b = $(a); if (b.length > 0) { var d = $.extend({}, bootstrapQ.bsdateoptions, c); b.each(function () { $(this).datepicker(d) }) } } };